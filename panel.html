<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LunarHost MC Panel</title>
<style>
body {
  font-family: Arial, sans-serif;
  background-color: #111;
  color: white;
  padding: 20px;
}
h1 { margin-bottom: 10px; }
button {
  padding: 10px 20px;
  font-size: 16px;
  margin-top: 10px;
  cursor: pointer;
  border: none;
  border-radius: 5px;
  background-color: #1a73e8;
  color: white;
}
button:hover { background-color: #155ab6; }
#cpuRam { margin-top: 15px; padding: 10px; background:#222; border-radius:5px; }
#console { margin-top: 15px; padding: 10px; background:#222; border-radius:5px; max-height:300px; overflow-y:auto; white-space:pre-line; }
</style>
</head>
<body>

<h1>LunarHost Minecraft Panel</h1>

<p>Version: <span id="versionDisplay"></span></p>
<p>Software: <span id="softwareDisplay"></span></p>

<button id="startBtn">Start Server</button>

<div id="cpuRam">CPU/RAM info will appear here</div>

<pre id="console">Server logs will appear here...</pre>

<script>
const version = localStorage.getItem('mcVersion') || "1.20.1";
const software = localStorage.getItem('mcSoftware') || "paper";

document.getElementById('versionDisplay').textContent = version;
document.getElementById('softwareDisplay').textContent = software;

const consoleDiv = document.getElementById('console');
const cpuDiv = document.getElementById('cpuRam');

document.getElementById('startBtn').addEventListener('click', async () => {
  consoleDiv.textContent = "Creating your personal Colab deployer notebook...\n";

  try {
    // Send request to your backend to create a user-specific Colab
    const user_id = "user" + Date.now(); // unique ID for each user
    const response = await fetch('https://your-backend-url/deployer', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({version, software, user_id})
    });

    const data = await response.json();
    const colab_link = data.colab_link;

    consoleDiv.textContent += "Colab notebook created!\n";
    consoleDiv.textContent += "Opening notebook...\n";

    // Open user-specific Colab notebook in a new tab
    window.open(colab_link, "_blank");

    consoleDiv.textContent += "Please run the cells in Colab to set up your server.\n";

  } catch(err) {
    consoleDiv.textContent += "Error creating Colab notebook: " + err + "\n";
  }
});

// Optional: CPU/RAM polling if your backend provides it
setInterval(async () => {
  try {
    const res = await fetch('https://your-backend-url/status');
    const stats = await res.json();
    cpuDiv.textContent = `CPU: ${stats.cpu}% | RAM: ${stats.ramUsed}/${stats.ramTotal} MB`;
  } catch(err) {
    cpuDiv.textContent = "CPU/RAM info unavailable";
  }
}, 5000);

</script>
</body>
</html>
